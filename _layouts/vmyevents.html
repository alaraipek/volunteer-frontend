---
layout: base 
---


    <script type="module">
  import { uri, options } from '{{site.baseurl}}/assets/js/api/config.js';
  if(isSignedIn())
        {

        }
        
            let jwt = getCookie("jwt");
            let data = parseJwt(jwt);
  var url = uri + '/api/events/get_by_id/'+data.id;
  const resultContainer = document.getElementById("result");

  fetch(url, options)
    .then(response => {
      if (response.status !== 200) {
        const errorMsg = 'Database response error: ' + response.status;
        console.log(errorMsg);
        const tr = document.createElement("tr");
        const td = document.createElement("td");
        td.innerHTML = errorMsg;
        tr.appendChild(td);
        resultContainer.appendChild(tr);
        return;
      }

      response.json().then(data => {
        console.log(data);
        for (const row of data) {
          const tr = document.createElement("tr");

          // Make each cell editable with input fields
          const name = document.createElement("td");
          const id = document.createElement("td");
          const age = document.createElement("td");
          const zip = document.createElement("td");
          const date = document.createElement("td");
            name.innerHTML = row.title;
            id.innerHTML = row.description; 
            age.innerHTML = row.address;
            zip.innerHTML = row.zipcode;
            date.innerHTML = row.date;

          tr.appendChild(name);
          tr.appendChild(id);
          tr.appendChild(age);
          tr.appendChild(zip);
          tr.appendChild(date);

          resultContainer.appendChild(tr);
        }
      })
    })
    .catch(err => {
      console.error(err);
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.innerHTML = err + ": " + url;
      tr.appendChild(td);
      resultContainer.appendChild(tr);
    });



    function isSignedIn()
    {
        //setCookie('jwt','rah', 1);
        
        let jwt = getCookie("jwt");
        if(jwt)
        {
            return true;
        }
        else
        {
            alert("Please Log In first!");
            return false;
        }
    }

    function getCookie(cname) {
        let name = cname + "=";
        let decodedCookie = decodeURIComponent(document.cookie);
        let ca = decodedCookie.split(';');
        for(let i = 0; i <ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) == ' ') {
            c = c.substring(1);
            }
            if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
            }
        }
        return "";
    }

    function parseJwt (token) {
        var base64Url = token.split('.')[1];
        var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));

        return JSON.parse(jsonPayload);
    }

</script>
<html>
    <body class="oppconn">
      <h3>My Events</h3>
      <br /><br />
        <table>
            <thead>
              <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Address</th>
                <th>Zip Code</th>
                <th>Event Date</th>
                
              </tr>
            </thead>
            <tbody id="result">
              <!-- javascript generated data -->
            </tbody>
          </table>
    </body>
</html>